"use strict";var Deck=function(){function c(c,e){var f=Date.now(),g=f+c,h=g+e,i={start:g,end:h};b.push(i),a||(a=!0,requestAnimationFrame(d));var j={start:function(b){return i.startcb=b,j},progress:function(b){return i.progresscb=b,j},end:function(b){return i.endcb=b,j}};return j}function d(){var c=Date.now();if(!b.length)return void(a=!1);for(var f,e=0;e<b.length;e++)if(f=b[e],!(c<f.start)){f.started||(f.started=!0,f.startcb&&f.startcb());var g=(c-f.start)/(f.end-f.start);f.progresscb&&f.progresscb(g<1?g:1),c>f.end&&(f.endcb&&f.endcb(),b.splice(e--,1))}requestAnimationFrame(d)}function g(a){if("undefined"!=typeof f[a])return f[a];if("undefined"!=typeof e[a])return f[a]=a,a;for(var d,b=a[0].toUpperCase()+a.slice(1),c=["webkit","moz","Moz","ms","o"],g=0,h=c.length;g<h;g++)if(d=c[g]+b,"undefined"!=typeof e[d])return f[a]=d,d}function i(a,b,c){return"undefined"!=typeof h||(h=j()),c=c||0,h?"translate3d("+a+", "+b+", "+c+")":"translate("+a+", "+b+")"}function j(){var a=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);if(!a)return!1;var b=g("transform"),c=document.createElement("p");return document.body.appendChild(c),c.style[b]="translate3d(1px,1px,1px)",h=c.style[b],h=null!=h&&h.length&&"none"!==h,document.body.removeChild(c),h}function k(a){return document.createElement(a)}function m(a){function w(a){a.card&&a.card(t)}function x(a){function f(a){r&&("mousemove"===a.type?(d.x=a.clientX,d.y=a.clientY):(d.x=a.touches[0].clientX,d.y=a.touches[0].clientY),h.style[b]=i(Math.round(t.x+d.x-c.x)+"px",Math.round(t.y+d.y-c.y)+"px")+(t.rot?" rotate("+t.rot+"deg)":""))}function g(a){s&&Date.now()-e<200&&t.setSide("front"===t.side?"back":"front"),"mouseup"===a.type?(p(window,"mousemove",f),p(window,"mouseup",g)):(p(window,"touchmove",f),p(window,"touchend",g)),r&&(t.x=t.x+d.x-c.x,t.y=t.y+d.y-c.y)}var c={},d={},e=Date.now();a.preventDefault(),"mousedown"===a.type?(c.x=d.x=a.clientX,c.y=d.y=a.clientY,o(window,"mousemove",f),o(window,"mouseup",g)):(c.x=d.x=a.touches[0].clientX,c.y=d.y=a.touches[0].clientY,o(window,"touchmove",f),o(window,"touchend",g)),r&&(h.style[b]=i(t.x+"px",t.y+"px")+(t.rot?" rotate("+t.rot+"deg)":""),h.style.zIndex=l++)}function y(a){a.appendChild(h),t.$root=a}function z(){t.$root&&t.$root.removeChild(h),t.$root=null}function A(a){"front"===a?("back"===t.side&&h.removeChild(m),t.side="front",h.appendChild(j),t.setRankSuit(t.rank,t.suit)):("front"===t.side&&h.removeChild(j),t.side="back",h.appendChild(m),h.setAttribute("class","card"))}var v,b=g("transform"),d=a%13+1,e=a/13|0,f=(52-a)/4,h=k("div"),j=k("div"),m=k("div"),r=!1,s=!1,t={i:a,rank:d,suit:e,pos:a,$el:h,mount:y,unmount:z,setSide:A},u=I.modules;j.classList.add("face"),m.classList.add("back"),h.style[b]=i(-f+"px",-f+"px"),t.x=-f,t.y=-f,t.z=f,t.rot=0,t.setSide("back"),o(h,"mousedown",x),o(h,"touchstart",x);for(v in u)w(u[v]);return t.animateTo=function(a){var s,u,v,w,x,y,d=a.delay,e=a.duration,f=a.x,g=void 0===f?t.x:f,j=a.y,k=void 0===j?t.y:j,l=a.rot,m=void 0===l?t.rot:l,n=a.ease,o=a.onStart,p=a.onProgress,r=a.onComplete;c(d,e).start(function(){s=t.x||0,u=t.y||0,v=t.rot||0,o&&o()}).progress(function(a){var c=q[n||"cubicInOut"](a);w=g-s,x=k-u,y=m-v,p&&p(a,c),t.x=s+w*c,t.y=u+x*c,t.rot=v+y*c,h.style[b]=i(t.x+"px",t.y+"px")+(y?"rotate("+t.rot+"deg)":"")}).end(function(){r&&r()})},t.setRankSuit=function(a,b){var c=n(b);h.setAttribute("class","card "+c+" rank"+a)},t.setRankSuit(d,e),t.enableDragging=function(){r||(r=!0,h.style.cursor="move")},t.enableFlipping=function(){s||(s=!0)},t.disableFlipping=function(){s&&(s=!1)},t.disableDragging=function(){r&&(r=!1,h.style.cursor="")},t}function n(a){return 0===a?"spades":1===a?"hearts":2===a?"clubs":3===a?"diamonds":"joker"}function o(a,b,c){a.addEventListener(b,c)}function p(a,b,c){a.removeEventListener(b,c)}function t(a){var b=Math.round(Math.random())?-1:1;return b*a}function u(a){for(var b,c,d=a.length-1;d;d--)b=Math.random()*d|0,c=a[d],a[d]=a[b],a[b]=c;return a}function v(){return window.getComputedStyle(document.body).getPropertyValue("font-size").slice(0,-2)}function D(a){return a*Math.PI/180}function G(a){function d(a){return function(){var c=this,d=arguments;e(function(e){a.apply(c,b.concat.apply(e,d))})}}function e(a){a&&(c.push(a),1===c.length&&f())}function f(){c[0](function(a){if(a)throw a;c=c.slice(1),c.length&&f()})}var b=Array.prototype,c=[];return a.queue=e,a.queued=d,a}function H(a){function c(a,c,d){b[a]||(b[a]=[]),b[a].push({cb:c,ctx:d})}function d(a,c,d){b[a]||(b[a]=[]),b[a].push({cb:c,ctx:d,once:!0})}function e(a){var c=this,d=Array.prototype.slice(arguments,1),e=b[a]||[];e.filter(function(a){return a.cb.apply(c,d),!a.once})}function f(a,c){return a?c?void(b[a]=b[a].filter(function(a){return a.cb!==c})):void(b[a]=[]):void(b={})}a||(a={});var b={};return a.on=c,a.one=d,a.off=f,a.trigger=e,a}function I(a,b){function n(a){g=a,g.appendChild(e)}function o(){g.removeChild(e)}function p(a){a.deck&&a.deck(f)}var g,i,c=a?54:52,d=new Array(c*b),e=k("div"),f=H({mount:n,unmount:o,cards:d,$el:e}),h=I.modules;G(f);for(i in h)p(h[i]);e.classList.add("deck");for(var j,l=d.length;l;l--)j=d[l-1]=m((l-1)%c),j.mount(e);return f}var a,b=[];window.requestAnimationFrame||(window.requestAnimationFrame=function(a){setTimeout(a,0)});var h,w,y,B,E,e=document.createElement("p").style,f={},l=52,q={linear:function(b){return b},quadIn:function(b){return b*b},quadOut:function(b){return b*(2-b)},quadInOut:function(b){return b<.5?2*b*b:-1+(4-2*b)*b},cubicIn:function(b){return b*b*b},cubicOut:function(b){return--b*b*b+1},cubicInOut:function(b){return b<.5?4*b*b*b:(b-1)*(2*b-2)*(2*b-2)+1},quartIn:function(b){return b*b*b*b},quartOut:function(b){return 1- --b*b*b*b},quartInOut:function(b){return b<.5?8*b*b*b*b:1-8*--b*b*b*b},quintIn:function(b){return b*b*b*b*b},quintOut:function(b){return 1+--b*b*b*b*b},quintInOut:function(b){return b<.5?16*b*b*b*b*b:1+16*--b*b*b*b*b}},r={deck:function(b){function c(a,c){var d=b.cards.filter(function(a){return"front"===a.side}).length/b.cards.length;b.cards.forEach(function(a,b){a.setSide(c?c:d>.5?"back":"front")}),a()}b.flip=b.queued(c)}},s={deck:function(b){function c(a,c){var d=b.cards;d.sort(function(a,b){return c?a.i-b.i:b.i-a.i}),d.forEach(function(b,e){b.sort(e,d.length,function(b){b===d.length-1&&a()},c)})}b.sort=b.queued(c)},card:function(b){var c=b.$el;b.sort=function(a,d,e,f){var g=a/4,h=10*a;b.animateTo({delay:h,duration:400,x:-g,y:-150,rot:0,onComplete:function(){c.style.zIndex=a}}),b.animateTo({delay:h+500,duration:400,x:-g,y:-g,rot:0,onComplete:function(){e(a)}})}}},x={deck:function(b){function c(a){var c=b.cards;w=v(),u(c),c.forEach(function(b,d){b.pos=d,b.shuffle(function(b){b===c.length-1&&a()})})}b.shuffle=b.queued(c)},card:function(b){var c=b.$el;b.shuffle=function(a){var d=b.pos,e=d/4,f=2*d;b.animateTo({delay:f,duration:200,x:t(40*Math.random()+20)*w/16,y:-e,rot:0}),b.animateTo({delay:200+f,duration:200,x:-e,y:-e,rot:0,onStart:function(){c.style.zIndex=d},onComplete:function(){a(d)}})}}},z={deck:function(b){function c(a){var c=b.cards,d=c.length;y=v(),c.slice(-5).reverse().forEach(function(b,c){b.poker(c,d,function(c){b.setSide("front"),4===c&&a()})})}b.poker=b.queued(c)},card:function(b){var c=b.$el;b.poker=function(a,d,e){var f=250*a;b.animateTo({delay:f,duration:250,x:Math.round(70*(a-2.05)*y/16),y:Math.round(-110*y/16),rot:0,onStart:function(){c.style.zIndex=d-1+a},onComplete:function(){e(a)}})}}},A={deck:function(b){function d(a){var d=b.cards;d.forEach(function(b,e){b.setSide("front"),b.intro(e,function(e){c(250,0).start(function(){b.setSide("back")}),e===d.length-1&&a()})})}b.intro=b.queued(d)},card:function(b){var c=g("transform"),d=b.$el;b.intro=function(a,e){var f=500+10*a,g=a/4;d.style[c]=i(-g+"px","-250px"),d.style.opacity=0,b.x=-g,b.y=-250-g,b.rot=0,b.animateTo({delay:f,duration:1e3,x:-g,y:-g,onStart:function(){d.style.zIndex=a},onProgress:function(b){d.style.opacity=b},onComplete:function(){d.style.opacity="",e&&e(a)}})}}},C={deck:function(b){function c(a){var c=b.cards,d=c.length;B=v(),c.forEach(function(b,e){b.fan(e,d,function(b){b===c.length-1&&a()})})}b.fan=b.queued(c)},card:function(b){var c=b.$el;b.fan=function(a,d,e){var f=a/4,g=10*a,h=a/(d-1)*260-130;b.animateTo({delay:g,duration:300,x:-f,y:-f,rot:0}),b.animateTo({delay:300+g,duration:300,x:55*Math.cos(D(h-90))*B/16,y:55*Math.sin(D(h-90))*B/16,rot:h,onStart:function(){c.style.zIndex=a},onComplete:function(){e(a)}})}}},F={deck:function(b){function c(a){var c=b.cards;E=v(),c.forEach(function(b){b.bysuit(function(b){b===c.length-1&&a()})})}b.bysuit=b.queued(c)},card:function(b){var c=b.rank,d=b.suit;b.bysuit=function(a){var e=b.i,f=10*e;b.animateTo({delay:f,duration:400,x:-Math.round(8*(6.75-c)*E/16),y:-Math.round(92*(1.5-d)*E/16),rot:0,onComplete:function(){a(e)}})}}};return I.animationFrames=c,I.ease=q,I.modules={bysuit:F,fan:C,intro:A,poker:z,shuffle:x,sort:s,flip:r},I.Card=m,I.prefix=g,I.translate=i,I}();